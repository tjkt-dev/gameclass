<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Game Snake</title>

<style>
*{box-sizing:border-box;font-family:Arial,Helvetica,sans-serif}
body{
  margin:0;
  background:#0f172a;
  color:white;
  display:flex;
  flex-direction:column;
  align-items:center;
}
.navbar{
  width:100%;
  background:#1e293b;
  padding:15px 30px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.navbar a{
  color:white;
  text-decoration:none;
  margin-left:20px;
  font-weight:bold;
}
canvas{
  background:#020617;
  border:4px solid #38bdf8;
  border-radius:8px;
  max-width:90vw;
}
.info{margin-top:10px;font-size:1.1em}
.btn{
  margin-top:10px;
  padding:10px 25px;
  background:#38bdf8;
  border:none;
  border-radius:6px;
  font-weight:bold;
}
.controls{text-align:center;margin-top:15px}
.controls button{
  width:60px;height:60px;margin:5px;
  font-size:24px;border-radius:12px;
  border:none;background:#38bdf8;
}
.controls button:active{background:#0ea5e9}
</style>
</head>

<body>

<div class="navbar">
  <h3>üêç Snake</h3>
  <nav>
    <a href="index.html">Beranda</a>
    <a href="hame.html">Game</a>
  </nav>
</div>

<h2>Game Snake</h2>
<p>Keyboard / Tombol layar</p>

<canvas id="game" width="400" height="400"></canvas>

<div class="info">
  Skor: <span id="score">0</span> |
  High Score: <span id="highScore">0</span>
</div>

<button class="btn" onclick="resetGame()">Restart</button>
<button class="btn" onclick="toggleMusic()">üéµ Music</button>

<div class="controls">
  <button onclick="setDirection('UP')">‚¨Ü</button>
  <div>
    <button onclick="setDirection('LEFT')">‚¨Ö</button>
    <button onclick="setDirection('DOWN')">‚¨á</button>
    <button onclick="setDirection('RIGHT')">‚û°</button>
  </div>
</div>

<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");
const box=20;
const size=20;

let snake,food,direction,score,highScore;
highScore=localStorage.getItem("snakeHighScore")||0;
document.getElementById("highScore").innerText=highScore;

/* ===== AUDIO ===== */
let audioCtx,musicOn=false;

function beep(freq,dur=0.1){
  if(!audioCtx) audioCtx=new (window.AudioContext||window.webkitAudioContext)();
  const o=audioCtx.createOscillator();
  const g=audioCtx.createGain();
  o.frequency.value=freq;
  o.type="square";
  o.connect(g);g.connect(audioCtx.destination);
  o.start();
  g.gain.exponentialRampToValueAtTime(0.0001,audioCtx.currentTime+dur);
  o.stop(audioCtx.currentTime+dur);
}

let musicOsc;
function toggleMusic(){
  if(!audioCtx) audioCtx=new (window.AudioContext||window.webkitAudioContext)();
  if(musicOn){
    musicOsc.stop();
    musicOn=false;
  }else{
    musicOsc=audioCtx.createOscillator();
    musicOsc.frequency.value=120;
    musicOsc.type="sine";
    musicOsc.connect(audioCtx.destination);
    musicOsc.start();
    musicOn=true;
  }
}

/* ===== GAME ===== */
function init(){
  snake=[{x:10,y:10}];
  direction="RIGHT";
  score=0;
  food=spawnFood();
  document.getElementById("score").innerText=score;
}

function spawnFood(){
  return{
    x:Math.floor(Math.random()*size),
    y:Math.floor(Math.random()*size)
  };
}

document.addEventListener("keydown",e=>{
  if(e.key==="ArrowUp")setDirection("UP");
  if(e.key==="ArrowDown")setDirection("DOWN");
  if(e.key==="ArrowLeft")setDirection("LEFT");
  if(e.key==="ArrowRight")setDirection("RIGHT");
});

function setDirection(dir){
  if(!audioCtx) audioCtx=new (window.AudioContext||window.webkitAudioContext)();
  if(dir==="UP"&&direction!=="DOWN")direction="UP";
  if(dir==="DOWN"&&direction!=="UP")direction="DOWN";
  if(dir==="LEFT"&&direction!=="RIGHT")direction="LEFT";
  if(dir==="RIGHT"&&direction!=="LEFT")direction="RIGHT";
}

function draw(){
  ctx.fillStyle="#020617";
  ctx.fillRect(0,0,canvas.width,canvas.height);

  ctx.fillStyle="#22c55e";
  snake.forEach(p=>ctx.fillRect(p.x*box,p.y*box,box,box));

  ctx.fillStyle="#ef4444";
  ctx.fillRect(food.x*box,food.y*box,box,box);

  let head={...snake[0]};
  if(direction==="UP")head.y--;
  if(direction==="DOWN")head.y++;
  if(direction==="LEFT")head.x--;
  if(direction==="RIGHT")head.x++;

  /* TEMBUS TEMBOK */
  if(head.x<0)head.x=size-1;
  if(head.x>=size)head.x=0;
  if(head.y<0)head.y=size-1;
  if(head.y>=size)head.y=0;

  /* MAKAN */
  if(head.x===food.x&&head.y===food.y){
    score++;
    beep(600);
    document.getElementById("score").innerText=score;
    food=spawnFood();
  }else{
    snake.pop();
  }

  /* MATI JIKA NABRAK EKOR */
  if(snake.some(p=>p.x===head.x&&p.y===head.y)){
    gameOver();
    return;
  }

  snake.unshift(head);
}

function gameOver(){
  beep(200,0.4);
  if(score>highScore){
    highScore=score;
    localStorage.setItem("snakeHighScore",highScore);
    document.getElementById("highScore").innerText=highScore;
  }
  alert("Game Over!");
  init();
}

function resetGame(){init();}

init();
setInterval(draw,140);
</script>

</body>
</html>